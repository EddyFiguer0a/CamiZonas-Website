<!-- ✅ Modal de Confirmación Reutilizable -->
<div id="confirm-modal" class="fixed inset-0 z-[150] hidden items-center justify-center p-4 bg-black/60 backdrop-blur-sm transition-opacity">
  <div class="bg-white rounded-3xl max-w-sm w-full shadow-2xl transform scale-95 transition-all duration-300" id="confirm-modal-content">
    
    <!-- Icono -->
    <div class="flex justify-center pt-8 pb-4">
      <div id="confirm-icon" class="w-16 h-16 rounded-full flex items-center justify-center">
        <!-- El ícono se inyecta dinámicamente -->
      </div>
    </div>

    <!-- Título -->
    <h3 id="confirm-title" class="text-xl font-black text-center px-6 mb-2">
      ¿Estás seguro?
    </h3>

    <!-- Mensaje -->
    <p id="confirm-message" class="text-sm text-gray-600 text-center px-6 mb-6">
      Esta acción no se puede deshacer
    </p>

    <!-- Botones -->
    <div class="flex gap-3 px-6 pb-6">
      <button 
        id="confirm-cancel" 
        class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-bold py-3.5 rounded-2xl transition-all duration-200 hover:scale-[1.02]"
      >
        Cancelar
      </button>
      <button 
        id="confirm-accept" 
        class="flex-1 bg-red-500 hover:bg-red-600 text-white font-bold py-3.5 rounded-2xl transition-all duration-200 hover:scale-[1.02] hover:shadow-lg"
      >
        Confirmar
      </button>
    </div>

  </div>
</div>

<script is:inline>
  window.showConfirm = function({
    title = '¿Estás seguro?',
    message = 'Esta acción no se puede deshacer',
    confirmText = 'Confirmar',
    cancelText = 'Cancelar',
    icon = 'warning',
    onConfirm = () => {},
    onCancel = () => {}
  }) {
    const modal = document.getElementById('confirm-modal');
    const modalContent = document.getElementById('confirm-modal-content');
    const titleEl = document.getElementById('confirm-title');
    const messageEl = document.getElementById('confirm-message');
    const iconEl = document.getElementById('confirm-icon');
    const confirmBtn = document.getElementById('confirm-accept');
    const cancelBtn = document.getElementById('confirm-cancel');

    if (!modal) return;

    titleEl.textContent = title;
    messageEl.textContent = message;
    confirmBtn.textContent = confirmText;
    cancelBtn.textContent = cancelText;

    const icons = {
      warning: {
        bg: 'bg-yellow-100',
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" class="text-yellow-600">
          <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/>
          <line x1="12" y1="9" x2="12" y2="13"/>
          <line x1="12" y1="17" x2="12.01" y2="17"/>
        </svg>`
      },
      danger: {
        bg: 'bg-red-100',
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" class="text-red-600">
          <path d="M3 6h18"/>
          <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
          <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
          <line x1="10" x2="10" y1="11" y2="17"/>
          <line x1="14" x2="14" y1="11" y2="17"/>
        </svg>`
      },
      info: {
        bg: 'bg-blue-100',
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" class="text-blue-600">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" y1="16" x2="12" y2="12"/>
          <line x1="12" y1="8" x2="12.01" y2="8"/>
        </svg>`
      }
    };

    const selectedIcon = icons[icon] || icons.warning;
    iconEl.className = `w-16 h-16 rounded-full flex items-center justify-center ${selectedIcon.bg}`;
    iconEl.innerHTML = selectedIcon.svg;

    modal.classList.remove('hidden');
    modal.classList.add('flex');
    
    requestAnimationFrame(() => {
      modal.style.opacity = '1';
      modalContent.style.transform = 'scale(1)';
    });

    const closeModal = () => {
      modal.style.opacity = '0';
      modalContent.style.transform = 'scale(0.95)';
      setTimeout(() => {
        modal.classList.add('hidden');
        modal.classList.remove('flex');
      }, 300);
    };

    const handleConfirm = () => {
      closeModal();
      onConfirm();
    };

    const handleCancel = () => {
      closeModal();
      onCancel();
    };

    const newConfirmBtn = confirmBtn.cloneNode(true);
    const newCancelBtn = cancelBtn.cloneNode(true);
    confirmBtn.parentNode.replaceChild(newConfirmBtn, confirmBtn);
    cancelBtn.parentNode.replaceChild(newCancelBtn, cancelBtn);

    document.getElementById('confirm-accept').addEventListener('click', handleConfirm);
    document.getElementById('confirm-cancel').addEventListener('click', handleCancel);

    modal.addEventListener('click', (e) => {
      if (e.target === modal) handleCancel();
    });

    const escHandler = (e) => {
      if (e.key === 'Escape') {
        handleCancel();
        document.removeEventListener('keydown', escHandler);
      }
    };
    document.addEventListener('keydown', escHandler);
  };
</script>

<style>
  #confirm-modal {
    opacity: 0;
    transition: opacity 300ms ease-out;
  }
  
  #confirm-modal-content {
    transform: scale(0.95);
    transition: transform 300ms cubic-bezier(0.34, 1.56, 0.64, 1);
  }
</style>